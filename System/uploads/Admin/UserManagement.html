<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Management - MATARIX</title>
    
    <!-- Bootstrap 4 CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/css/bootstrap.min.css">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS File -->
    <link rel="stylesheet" href="../Admin_assets/css/UserManagement.css">
    <!-- Admin Notification System -->
    <link rel="stylesheet" href="../Admin_assets/css/admin-notifications.css">
</head>
<body>

    <!-- MAIN HEADER SECTION -->
    <header class="main-header">
        <div class="container-fluid">
            <div class="row align-items-center">
                
                <!-- LEFT SECTION: MATARIX Logo -->
                <div class="col-md-4">
                    <div class="logo-container">
                        <!-- MATARIX LOGO IMAGE -->
                        <img src="../Admin_assets/images/logo.png" alt="MATARIX Logo" class="logo-image">
                    </div>
                </div>
                
                <!-- CENTER SECTION: Empty (Search removed) -->
                <div class="col-md-4"></div>
                
                <!-- RIGHT SECTION: Header Action Icons -->
                <div class="col-md-4">
                    <div class="header-actions">
                        <!-- EMAIL/MESSAGES ICON BUTTON -->
                        <!-- NOTIFICATIONS ICON BUTTON -->
                        <button class="header-action-btn" id="notifications-btn" title="Notifications">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                        </button>

                       <!-- USER PROFILE ICON BUTTON - Now clickable with href -->
                        <a href="../Admin/AdminProfile.html" class="header-action-btn" id="profile-btn">
                            <i class="fas fa-user-circle"></i>
                        </a>

                    </div>
                </div>
                
            </div>
        </div>
    </header>

    <!-- MAIN LAYOUT CONTAINER -->
    <div class="main-layout">
        <div class="container-fluid">
            <div class="row">
                
                <!-- ==========================================
                     LEFT SIDEBAR NAVIGATION - DEFAULT FOR ALL ADMIN PAGES
                ========================================== -->
                <aside class="col-md-2 sidebar-container">
                    <nav class="sidebar-nav">
                        
                        <!-- SIDEBAR NAVIGATION LINKS -->
                        <ul class="nav-links">
                            <!-- ORDERS NAVIGATION LINK -->
                            <li>
                                <a href="../Admin/OrdersAdmin.html" class="nav-link" id="orders-nav">
                                    <span>Orders</span>
                                </a>
                            </li>
                            
                            <!-- INVENTORY NAVIGATION LINK -->
                            <li>
                                <a href="../Admin/InventoryAdmin.html" class="nav-link" id="inventory-nav">
                                    <span>Inventory</span>
                                </a>
                            </li>
                            
                            <!-- DELIVERIES NAVIGATION LINK -->
                            <li>
                                <a href="../Admin/DeliveriesAdmin.html" class="nav-link" id="deliveries-nav">
                                    <span>Deliveries</span>
                                </a>
                            </li>
                            
                            <!-- ANALYTICS NAVIGATION LINK -->
                            <li>
                                <a href="../Admin/ReportsAdmin.html" class="nav-link" id="analytics-nav">
                                    <span>Sales and Reports</span>
                                </a>
                            </li>
                            
                            <!-- USER MANAGEMENT NAVIGATION LINK (ACTIVE) -->
                            <li>
                                <a href="../Admin/UserManagement.html" class="nav-link active" id="user-management-nav">
                                    <span>User Management</span>
                                </a>
                            </li>
                        </ul>     
                    </nav>
                    
                    <!-- SIDEBAR FOOTER WITH LOGOUT BUTTON -->
                    <div class="sidebar-footer">
                        <!-- LOGOUT BUTTON -->
                        <button class="logout-button">Logout</button>
                    </div>
                </aside>

                <!-- MAIN CONTENT AREA -->
                <main class="col-md-10 main-content">
                    
                    <!-- PAGE HEADER WITH TITLE AND MANAGE PERMISSIONS BUTTON -->
                    <div class="content-header">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="page-title">User Management</h1>
                                <p class="page-subtitle">Manage users</p>
                            </div>
                            <div class="col-md-4 text-right">
                                <!-- Manage Permissions button removed - permissions are set automatically based on roles -->
                            </div>
                        </div>
                    </div>

                    <!-- USER ROLE TABS SECTION -->
                    <div class="user-role-tabs-section">
                        <ul class="role-tabs" id="role-tabs">
                            <li class="role-tab active" data-role="">
                                <i class="fas fa-users"></i>
                                <span>All Users</span>
                            </li>
                            <li class="role-tab" data-role="admin">
                                <i class="fas fa-user-shield"></i>
                                <span>Admin</span>
                            </li>
                            <li class="role-tab" data-role="employee">
                                <i class="fas fa-user-tie"></i>
                                <span>Store Employee</span>
                            </li>
                            <li class="role-tab" data-role="delivery-driver">
                                <i class="fas fa-truck"></i>
                                <span>Delivery Driver</span>
                            </li>
                            <li class="role-tab" data-role="customer">
                                <i class="fas fa-user"></i>
                                <span>Customer</span>
                            </li>
                        </ul>
                    </div>

                    <!-- USER FILTERS SECTION -->
                    <div class="user-filters">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <div class="filter-controls">
                                    <!-- ALL STATUS FILTER DROPDOWN -->
                                    <select class="filter-dropdown" id="status-filter">
                                        <option value="">All Status</option>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <!-- SEARCH INPUT FIELD -->
                                <div class="search-container">
                                    <input type="text" class="search-input form-control" placeholder="Search" id="user-search">
                                    <i class="fas fa-search search-icon"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ADD USER BUTTON AND DELETE SELECTED BUTTON -->
                    <div class="add-user-section">
                        <div class="row">
                            <div class="col-md-6">
                                <button class="delete-selected-btn" id="delete-selected-btn" style="display: none;">
                                    <i class="fas fa-trash"></i>
                                    <span>Delete Selected (<span id="selected-count">0</span>)</span>
                                </button>
                            </div>
                            <div class="col-md-6 text-right">
                                <button class="add-user-btn" id="add-user-btn"><span>Add User</span></button>
                            </div>
                        </div>
                    </div>

                    <!-- USER LIST TABLE SECTION -->
                    <div class="user-list-section">
                        
                        <!-- USER LIST HEADER -->
                        <div class="section-header">
                            <h2 class="section-title">User List</h2>
                        </div>
                        
                        <!-- USER TABLE -->
                        <div class="table-responsive">
                            <table class="user-table table">
                                
                                <!-- TABLE HEADERS -->
                                <thead>
                                    <tr>
                                        <th><input type="checkbox" class="select-all-checkbox" id="select-all"></th>
                                        <th>User</th>
                                        <th>Email</th>
                                        <th>Contact</th>
                                        <th>Role</th>
                                        <th>Status</th>
                                        <th>Created</th>
                                        <th>Last Login</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                
                                <!-- TABLE BODY WITH USER ROWS -->
                                <tbody id="users-table-body">
                                    <!-- Users will be loaded dynamically here -->
                                    <tr class="user-row loading-row">
                                        <td colspan="9" class="text-center">
                                            <div class="spinner-border text-primary" role="status">
                                                <span class="sr-only">Loading...</span>
                                            </div>
                                            <p class="mt-2">Loading users...</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- PAGINATION SECTION -->
                        <div class="pagination-section">
                            <div class="row align-items-center">
                                <div class="col-md-6">
                                    <div class="showing-info" id="showing-info">Loading...</div>
                                </div>
                                <div class="col-md-6">
                                    <div class="pagination-controls">
                                        <button class="pagination-btn" id="prev-btn" disabled>Previous</button>
                                        <span class="page-number" id="current-page">1</span>
                                        <button class="pagination-btn" id="next-btn" disabled>Next</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </main>
            </div>
        </div>
    </div>


    <!-- ADD USER MODAL POPUP -->
    <div class="modal fade" id="addUserModal" tabindex="-1" role="dialog" aria-labelledby="addUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered edit-user-modal-dialog" role="document">
            <div class="modal-content edit-user-modal">
                
                <div class="modal-header edit-user-header">
                    <h2 class="modal-title edit-user-title" id="addUserModalLabel">Add New User</h2>
                    <button type="button" class="close modal-close-btn" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                
                <div class="modal-body edit-user-body">
                    <form id="addUserForm">
                        <!-- FIRST NAME INPUT FIELD -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="addFirstName" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">First Name</label>
                            <input type="text" class="form-control user-input" id="addFirstName" placeholder="Enter First Name" required style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <!-- MIDDLE NAME INPUT FIELD (OPTIONAL) -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="addMiddleName" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Middle Name <span class="text-muted" style="font-size: 0.75em; font-weight: normal;">(Optional)</span></label>
                            <input type="text" class="form-control user-input" id="addMiddleName" placeholder="Enter Middle Name" style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <!-- LAST NAME INPUT FIELD -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="addLastName" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Last Name</label>
                            <input type="text" class="form-control user-input" id="addLastName" placeholder="Enter Last Name" required style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <!-- EMAIL ADDRESS INPUT FIELD -->
                        <div class="form-group" style="margin-bottom: 1rem;">
                            <label for="addEmailAddress" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Email Address</label>
                            <input type="email" class="form-control user-input" id="addEmailAddress" placeholder="Enter Email Address" required style="height: 45px;">
                        </div>
                        
                        <div class="row">
                            
                            <!-- PHONE NUMBER INPUT FIELD -->
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem;">
                                    <label for="addPhoneNumber" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Phone Number</label>
                                    <input type="tel" class="form-control user-input" id="addPhoneNumber" placeholder="Enter Phone Number" style="height: 45px;">
                                </div>
                            </div>
                            
                            <!-- ROLE DROPDOWN FIELD -->
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem;">
                                    <label for="addUserRole" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Role</label>
                                    <select class="form-control user-select" id="addUserRole" required style="height: 45px;">
                                        <option value="">Select Role</option>
                                        <option value="admin">Admin</option>
                                        <option value="employee">Store Employee</option>
                                        <option value="delivery-driver">Delivery Driver</option>
                                        <option value="customer">Customer</option>
                                    </select>
                                </div>
                            </div>
                            
                        </div>

                        <!-- ROLE PERMISSIONS PREVIEW (READ-ONLY) -->
                        <div class="form-group" style="margin-bottom: 1rem;">
                            <label class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Role Permissions (read-only)</label>
                            <div id="rolePermissionPreview" class="rbac-preview" aria-live="polite">
                                <small class="text-muted">Select a role to preview its fixed permissions. Permissions are locked after account creation.</small>
                            </div>
                        </div>
                        
                        <!-- STRUCTURED ADDRESS FIELDS -->
                        <div class="form-group" style="margin-bottom: 1rem;">
                            <label for="addAddressStreet" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Street Address</label>
                            <input type="text" class="form-control user-input" id="addAddressStreet" placeholder="Enter street address, building, house number" required style="height: 45px;">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="addAddressRegion" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Region</label>
                                    <select class="form-control user-input" id="addAddressRegion" required style="width: 100%; height: 45px; box-sizing: border-box;">
                                        <option value="">Select Region</option>
                                        <option value="Region III (Central Luzon)">Region III (Central Luzon)</option>
                                        <option value="National Capital Region (NCR)">National Capital Region (NCR)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="addAddressDistrict" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Province/District</label>
                                    <select class="form-control user-input" id="addAddressDistrict" required style="width: 100%; height: 45px; box-sizing: border-box;">
                                        <option value="">Select Province/District</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="addAddressCity" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">City/Municipality</label>
                            <select class="form-control user-input" id="addAddressCity" required style="width: 100%; height: 45px; box-sizing: border-box;">
                                <option value="">Select City/Municipality</option>
                            </select>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="addAddressPostalCode" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Postal Code</label>
                                    <input type="text" class="form-control user-input" id="addAddressPostalCode" placeholder="Enter postal code" pattern="[0-9]{4}" maxlength="4" required style="width: 100%; height: 45px; box-sizing: border-box;">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="addAddressBarangay" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Barangay</label>
                                    <select class="form-control user-input" id="addAddressBarangay" required style="width: 100%; height: 45px; box-sizing: border-box;">
                                        <option value="">Select Barangay</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            
                            <!-- PASSWORD INPUT FIELD -->
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="addUserPassword" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Password</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" class="form-control user-input" id="addUserPassword" placeholder="Enter Password" required style="width: 100%; height: 45px; box-sizing: border-box; padding-right: 40px;">
                                        <button type="button" class="password-toggle-btn" id="toggleAddPassword" aria-label="Show password">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- CONFIRM PASSWORD INPUT FIELD -->
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="addConfirmPassword" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Confirm Password</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" class="form-control user-input" id="addConfirmPassword" placeholder="Re-enter Password" required style="width: 100%; height: 45px; box-sizing: border-box; padding-right: 40px;">
                                        <button type="button" class="password-toggle-btn" id="toggleAddConfirmPassword" aria-label="Show password">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <small id="addPasswordMatchError" class="text-danger" style="display: none; margin-top: 5px;">Passwords do not match</small>
                                </div>
                            </div>
                            
                        </div>
                        
                        <!-- STATUS SECTION -->
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <div class="status-options">
                                <label class="status-option">
                                    <input type="radio" name="addUserStatus" value="active" class="status-radio" checked>
                                    <span class="status-indicator status-active-indicator"></span>
                                    <span class="status-text">Active User</span>
                                </label>
                                
                                <label class="status-option">
                                    <input type="radio" name="addUserStatus" value="inactive" class="status-radio">
                                    <span class="status-indicator status-inactive-indicator"></span>
                                    <span class="status-text">Inactive User</span>
                                </label>
                            </div>
                        </div>
                        
                    </form>
                </div>
                
                <div class="modal-footer edit-user-footer">
                    <button type="button" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn save-edit-btn" form="addUserForm">Add User</button>
                </div>
                
            </div>
        </div>
    </div>

    <!-- EDIT USER MODAL POPUP -->
    <div class="modal fade" id="editUserModal" tabindex="-1" role="dialog" aria-labelledby="editUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered edit-user-modal-dialog" role="document">
            <div class="modal-content edit-user-modal">
                
                <div class="modal-header edit-user-header">
                    <h2 class="modal-title edit-user-title" id="editUserModalLabel">Edit User</h2>
                    <button type="button" class="close modal-close-btn" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                
                <div class="modal-body edit-user-body">
                    <form id="editUserForm">
                        <!-- FIRST NAME INPUT FIELD -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="firstName" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">First Name</label>
                            <input type="text" class="form-control user-input" id="firstName" placeholder="Enter First Name" required style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <!-- MIDDLE NAME INPUT FIELD (OPTIONAL) -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="middleName" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Middle Name <span class="text-muted" style="font-size: 0.75em; font-weight: normal;">(Optional)</span></label>
                            <input type="text" class="form-control user-input" id="middleName" placeholder="Enter Middle Name" style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <!-- LAST NAME INPUT FIELD -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="lastName" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Last Name</label>
                            <input type="text" class="form-control user-input" id="lastName" placeholder="Enter Last Name" required style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <!-- EMAIL ADDRESS INPUT FIELD -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="emailAddress" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Email Address</label>
                            <input type="email" class="form-control user-input" id="emailAddress" placeholder="Enter Email Address" required style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <div class="row">
                            
                            <!-- PHONE NUMBER INPUT FIELD -->
                            <div class="col-md-12">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="phoneNumber" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Phone Number</label>
                                    <input type="tel" class="form-control user-input" id="phoneNumber" placeholder="Enter Phone Number" style="width: 100%; height: 45px; box-sizing: border-box;">
                                </div>
                            </div>
                            
                            <!-- ROLE FIELD REMOVED - Role cannot be edited, permissions are set automatically based on role -->
                            
                        </div>
                        
                        <!-- STRUCTURED ADDRESS FIELDS -->
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="editAddressStreet" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Street Address</label>
                            <input type="text" class="form-control user-input" id="editAddressStreet" placeholder="Enter street address, building, house number" style="width: 100%; height: 45px; box-sizing: border-box;">
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="editAddressRegion" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Region</label>
                                    <select class="form-control user-input" id="editAddressRegion" style="width: 100%; height: 45px; box-sizing: border-box;">
                                        <option value="">Select Region</option>
                                        <option value="Region III (Central Luzon)">Region III (Central Luzon)</option>
                                        <option value="National Capital Region (NCR)">National Capital Region (NCR)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="editAddressDistrict" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Province/District</label>
                                    <select class="form-control user-input" id="editAddressDistrict" style="width: 100%; height: 45px; box-sizing: border-box;">
                                        <option value="">Select Province/District</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                            <label for="editAddressCity" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">City/Municipality</label>
                            <select class="form-control user-input" id="editAddressCity" style="width: 100%; height: 45px; box-sizing: border-box;">
                                <option value="">Select City/Municipality</option>
                            </select>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="editAddressPostalCode" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Postal Code</label>
                                    <input type="text" class="form-control user-input" id="editAddressPostalCode" placeholder="Enter postal code" pattern="[0-9]{4}" maxlength="4" style="width: 100%; height: 45px; box-sizing: border-box;">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="editAddressBarangay" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Barangay</label>
                                    <select class="form-control user-input" id="editAddressBarangay" style="width: 100%; height: 45px; box-sizing: border-box;">
                                        <option value="">Select Barangay</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            
                            <!-- PASSWORD INPUT FIELD -->
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="userPassword" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Password (leave blank to keep current)</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" class="form-control user-input" id="userPassword" placeholder="Enter New Password" style="width: 100%; height: 45px; box-sizing: border-box; padding-right: 40px;">
                                        <button type="button" class="password-toggle-btn" id="toggleEditPassword" aria-label="Show password">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- CONFIRM PASSWORD INPUT FIELD -->
                            <div class="col-md-6">
                                <div class="form-group" style="margin-bottom: 1rem; width: 100%;">
                                    <label for="confirmPassword" class="form-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Confirm Password</label>
                                    <div class="password-input-wrapper">
                                        <input type="password" class="form-control user-input" id="confirmPassword" placeholder="Re-enter Password" style="width: 100%; height: 45px; box-sizing: border-box; padding-right: 40px;">
                                        <button type="button" class="password-toggle-btn" id="toggleEditConfirmPassword" aria-label="Show password">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <small id="editPasswordMatchError" class="text-danger" style="display: none; margin-top: 5px;">Passwords do not match</small>
                                </div>
                            </div>
                            
                        </div>
                        
                        <input type="hidden" id="editUserId" value="">
                        
                        <!-- STATUS SECTION -->
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <div class="status-options">
                                <label class="status-option">
                                    <input type="radio" name="userStatus" value="active" class="status-radio" checked>
                                    <span class="status-indicator status-active-indicator"></span>
                                    <span class="status-text">Active User</span>
                                </label>

                                <label class="status-option">
                                    <input type="radio" name="userStatus" value="inactive" class="status-radio">
                                    <span class="status-indicator status-inactive-indicator"></span>
                                    <span class="status-text">Inactive User</span>
                                </label>
                            </div>
                        </div>
                        
                    </form>
                </div>
                
                <div class="modal-footer edit-user-footer">
                    <button type="button" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn save-edit-btn" form="editUserForm">Save Edit</button>
                </div>
                
            </div>
        </div>
    </div>

    <!-- VIEW USER DETAILS MODAL -->
    <div class="modal fade" id="viewUserModal" tabindex="-1" role="dialog" aria-labelledby="viewUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content edit-user-modal">
                
                <div class="modal-header edit-user-header">
                    <h2 class="modal-title edit-user-title" id="viewUserModalLabel">User Details</h2>
                    <button type="button" class="close modal-close-btn" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                
                <div class="modal-body edit-user-body">
                    <div class="user-details-container">
                        <div class="row">
                            <div class="col-md-12 text-center mb-4">
                                <div class="user-avatar-large mb-3">
                                    <i class="fas fa-user-circle" style="font-size: 80px; color: #6c757d;"></i>
                                </div>
                                <h3 id="viewUserName" class="mb-2"></h3>
                                <p id="viewUserEmail" class="text-muted mb-1"></p>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="detail-item">
                                    <label class="detail-label">
                                        <i class="fas fa-id-card" style="color: #dc3545;"></i> User ID
                                    </label>
                                    <p class="detail-value" id="viewUserId"></p>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="detail-item">
                                    <label class="detail-label">
                                        <i class="fas fa-user-tag" style="color: #dc3545;"></i> Role
                                    </label>
                                    <p class="detail-value" id="viewUserRole"></p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="detail-item">
                                    <label class="detail-label">
                                        <i class="fas fa-info-circle" style="color: #dc3545;"></i> Status
                                    </label>
                                    <p class="detail-value" id="viewUserStatus"></p>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="detail-item">
                                    <label class="detail-label">
                                        <i class="fas fa-calendar-plus" style="color: #dc3545;"></i> Account Created
                                    </label>
                                    <p class="detail-value" id="viewUserCreated"></p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="detail-item">
                                    <label class="detail-label">
                                        <i class="fas fa-phone" style="color: #dc3545;"></i> Phone Number
                                    </label>
                                    <p class="detail-value" id="viewUserPhone"></p>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="detail-item">
                                    <label class="detail-label">
                                        <i class="fas fa-clock" style="color: #dc3545;"></i> Last Login
                                    </label>
                                    <p class="detail-value" id="viewUserLastLogin"></p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <div class="detail-item">
                                    <label class="detail-label">
                                        <i class="fas fa-map-marker-alt" style="color: #dc3545;"></i> Address
                                    </label>
                                    <p class="detail-value" id="viewUserAddress"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer edit-user-footer">
                    <button type="button" class="btn cancel-btn" data-dismiss="modal">Close</button>
                </div>
                
            </div>
        </div>
    </div>

    <!-- Bootstrap 4 JavaScript Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.bundle.min.js"></script>
    
    <!-- USER MANAGEMENT PAGE JAVASCRIPT -->
    <!-- Admin Authentication Check - MUST load first to verify session -->
    <script src="../Admin_assets/js/admin_auth_check.js"></script>
    
    <!-- URL Authentication Helper - MUST load to preserve user_id in URLs -->
    <script src="../Customer_assets/js/url_auth_helper.js"></script>
    
    <!-- Admin Notifications - For confirmation dialogs -->
    <script src="../Admin_assets/js/admin-notifications.js"></script>
    
    <!-- Admin Order Notifications - Polls for new order notifications -->
    <script src="../Admin_assets/js/admin-order-notifications.js"></script>
    
    <!-- Admin Notification Center - Mailbox for viewing all notifications -->
    <script src="../Admin_assets/js/admin-notification-center.js"></script>
    
    <!-- Philippine Address Selector - MUST load before UserManagement.js -->
    <script src="../Customer_assets/js/ph_address_selector.js"></script>
    
    <script src="../Admin_assets/js/UserManagement.js"></script>
    
    <!-- Notifications Center Modal -->
    <div class="modal fade" id="notificationsModal" tabindex="-1" role="dialog" aria-labelledby="notificationsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="notificationsModalLabel">
                        <i class="fas fa-bell mr-2"></i>Notifications
                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="max-height: 600px; overflow-y: auto;">
                    <div id="notificationsLoading" class="text-center py-4">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p class="text-muted mt-2">Loading notifications...</p>
                    </div>
                    <div id="notificationsList" style="display: none;">
                        <!-- Notifications will be loaded here -->
                    </div>
                    <div id="notificationsEmpty" class="text-center py-5" style="display: none;">
                        <i class="fas fa-inbox" style="font-size: 3rem; color: #ccc;"></i>
                        <p class="text-muted mt-3">No notifications yet</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="markAllReadBtn" style="display: none;">
                        <i class="fas fa-check-double mr-2"></i>Mark All as Read
                    </button>
                </div>
            </div>
        </div>
    </div>
    
</body>
</html>